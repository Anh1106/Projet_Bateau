{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport React, { useState, useEffect } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { purchasedProduct } from \"../src/Products\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Button(props) {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isSelected = _useState2[0],\n    setIsSelected = _useState2[1];\n  useEffect(function () {\n    loadSelection();\n  }, []);\n  var loadSelection = function () {\n    var _ref = _asyncToGenerator(function* () {\n      if (props.item) {\n        try {\n          var storedSelection = yield AsyncStorage.getItem(props.item.title);\n          if (storedSelection !== null) {\n            setIsSelected(storedSelection === \"true\");\n          }\n        } catch (error) {\n          console.error(\"Erreur lors du chargement de la sélection depuis AsyncStorage: \", error);\n        }\n      }\n    });\n    return function loadSelection() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var toggleSelection = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var updatedPurchase = !isSelected;\n      try {\n        yield AsyncStorage.setItem(props.item.title, updatedPurchase.toString());\n      } catch (error) {\n        console.error(\"Erreur lors de la mise à jour de la sélection dans AsyncStorage: \", error);\n      }\n      setIsSelected(updatedPurchase);\n      if (updatedPurchase) {\n        purchasedProduct.push(props.item);\n      } else {\n        var index = purchasedProduct.findIndex(function (item) {\n          return item === props.item;\n        });\n        if (index !== -1) {\n          purchasedProduct.splice(index, 1);\n        }\n      }\n      console.log(\"Produits sélectionnés : \", purchasedProduct);\n    });\n    return function toggleSelection() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsxs(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      if (!props.disabled) {\n        props.navigation.navigate(props.screen);\n      } else {\n        toggleSelection();\n      }\n    },\n    children: [_jsx(Image, {\n      style: styles.image,\n      source: props.image\n    }), _jsxs(Text, {\n      style: styles.text,\n      children: [props.text, \" \"]\n    }), isSelected && _jsx(Text, {\n      children: \"OK\"\n    }), props.price && _jsxs(Text, {\n      children: [props.price, \"\\u20AC\"]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  button: {\n    flex: 1,\n    alignItems: \"center\",\n    backgroundColor: \"rgba(45, 45, 45, 0.3)\",\n    flexDirection: \"row\",\n    height: 100,\n    padding: \"3%\",\n    borderWidth: 1,\n    margin: \"1%\"\n  },\n  text: {\n    color: \"white\",\n    fontSize: 15,\n    marginLeft: 10\n  },\n  image: {\n    width: 60,\n    height: 60\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","AsyncStorage","purchasedProduct","jsx","_jsx","jsxs","_jsxs","Button","props","_useState","_useState2","_slicedToArray","isSelected","setIsSelected","loadSelection","_ref","_asyncToGenerator","item","storedSelection","getItem","title","error","console","apply","arguments","toggleSelection","_ref2","updatedPurchase","setItem","toString","push","index","findIndex","splice","log","TouchableOpacity","style","styles","button","onPress","disabled","navigation","navigate","screen","children","Image","image","source","Text","text","price","StyleSheet","create","flex","alignItems","backgroundColor","flexDirection","height","padding","borderWidth","margin","color","fontSize","marginLeft","width"],"sources":["/home/quangminh/ESGI/Projet_Bateau/components/Button.tsx"],"sourcesContent":["import { Text, TouchableOpacity, StyleSheet, Image } from \"react-native\";\nimport React, { useState, useEffect } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { purchasedProduct } from \"../src/Products\";\n\nexport default function Button(props: any) {\n  const [isSelected, setIsSelected] = useState(false);\n\n  useEffect(() => {\n    // Charger l'état de sélection (achat) depuis AsyncStorage au montage du composant\n    loadSelection();\n  }, []);\n\n  const loadSelection = async () => {\n    if (props.item) { // Vérifiez d'abord si props.item est défini\n      try {\n        const storedSelection = await AsyncStorage.getItem(props.item.title);\n        if (storedSelection !== null) {\n          setIsSelected(storedSelection === \"true\");\n        }\n      } catch (error) {\n        console.error(\n          \"Erreur lors du chargement de la sélection depuis AsyncStorage: \",\n          error\n        );\n      }\n    }\n  };\n  \n  const toggleSelection = async () => {\n    const updatedPurchase = !isSelected;\n\n    try {\n      // Stocker l'état de sélection (achat) dans AsyncStorage\n      await AsyncStorage.setItem(props.item.title, updatedPurchase.toString());\n    } catch (error) {\n      console.error(\n        \"Erreur lors de la mise à jour de la sélection dans AsyncStorage: \",\n        error\n      );\n    }\n\n    setIsSelected(updatedPurchase);\n\n    if (updatedPurchase) {\n      purchasedProduct.push(props.item);\n    } else {\n      const index = purchasedProduct.findIndex((item) => item === props.item);\n      if (index !== -1) {\n        purchasedProduct.splice(index, 1);\n      }\n    }\n\n    console.log(\"Produits sélectionnés : \", purchasedProduct);\n  };\n\n  return (\n    <TouchableOpacity\n      style={styles.button}\n      onPress={() => {\n        if (!props.disabled) {\n          props.navigation.navigate(props.screen);\n        } else {\n          toggleSelection();\n        }\n      }}\n    >\n      <Image style={styles.image} source={props.image}></Image>\n      <Text style={styles.text}>{props.text} </Text>\n      {isSelected && <Text>OK</Text>}\n      {props.price && <Text>{props.price}€</Text>}\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    flex: 1,\n    alignItems: \"center\",\n    backgroundColor: \"rgba(45, 45, 45, 0.3)\",\n    flexDirection: \"row\",\n    height: 100,\n    padding: \"3%\",\n    borderWidth: 1,\n    margin: \"1%\",\n  },\n  text: {\n    color: \"white\",\n    fontSize: 15,\n    marginLeft: 10,\n  },\n  image: {\n    width: 60,\n    height: 60,\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}